#!/bin/bash

# the original idea was condensed down to these few lines... before being expanded again to handle a date(1) compatible offset in $1
#
#d=$(date "+%a %b %d %T %Y %Z")
bon=$(tput rev)
boff=$(tput sgr0)
#
#zdump US/Hawaii US/Alaska US/Pacific US/Mountain US/Central US/Eastern Pacific/Easter Brazil/East UTC Europe/London Europe/Rome Africa/Cairo Asia/Baghdad Europe/Moscow Asia/Calcutta Asia/Bangkok Asia/Hong_Kong Australia/West Asia/Tokyo Australia/North Australia/Brisbane Australia/South Australia/NSW Pacific/Fiji Pacific/Auckland | sed -e "s/  /,/g ; s/, /,/g ; s/$d/$bon$d$boff/g" | column -t -s,


when=${1:-now}
z=$(date -d "$when" "+%z")

# TODO: 
# indicate timezone name as well. 
# debian: text string in /etc/timezone
# centos/rh: binary contents of /etc/localtime (might be symlink sometimes?)

(for t in US/Hawaii US/Alaska US/Pacific US/Mountain US/Central US/Eastern Pacific/Easter Brazil/East UTC Europe/London Europe/Rome Africa/Cairo Asia/Baghdad Europe/Moscow Asia/Calcutta Asia/Bangkok Asia/Hong_Kong Australia/West Asia/Tokyo Australia/North Australia/South Australia/Brisbane Australia/NSW Pacific/Fiji Pacific/Auckland ; do
    echo "$t,$(TZ=$t date -d "$when" "+%z, %a %b %d %T %Y %Z$boff")"
done) | sed -e "s/$z/$bon$z/g" | column -t -s,
